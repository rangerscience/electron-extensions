"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const electron_1 = require("electron");
const cookies_1 = require("../../common/apis/cookies");
const handler_1 = tslib_1.__importDefault(require("../engine/handler"));
// todo(hugo) check permisions for URLs
const ELECTRON_TO_CRX_COOKIE_CHANGE_CAUSE = {
    explicit: 'explicit',
    overwrite: 'overwrite',
    expired: 'expired',
    evicted: 'evicted',
    'expired-overwrite': 'expired_overwrite',
};
class Cookies extends handler_1.default {
    constructor(extensionId, emitter) {
        super(extensionId, emitter);
        this.electronCookies = electron_1.session.defaultSession.cookies;
        this.electronCookies.addListener('changed', (_, cookie, cause, removed) => {
            const cxCookie = this.electronCookieToCxCookie(cookie);
            const cxCause = ELECTRON_TO_CRX_COOKIE_CHANGE_CAUSE[cause];
            const details = {
                cookie: cxCookie,
                cause: cxCause,
                removed,
            };
            this.emit(cookies_1.Events.OnChanged, details);
        });
    }
    handleGet(details) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            const { url, name } = details; // warning(hugo) ignore storeId
            return new Promise((resolve) => {
                this.electronCookies.get({ url, name }, (_error, cookies) => {
                    if (cookies && cookies[0]) {
                        const cookie = cookies[0];
                        resolve(this.electronCookieToCxCookie(cookie));
                    }
                    // "This parameter is null if no such cookie was found"
                    // https://developer.chrome.com/extensions/cookies#property-get-callback
                    resolve(null);
                });
            });
        });
    }
    handleGetAll(details) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            const { url, name, domain, path, secure, session } = details;
            // warning(hugo) ignore storeId
            return new Promise((resolve) => {
                this.electronCookies.get({ url, name, domain, path, secure, session }, (_error, cookies) => {
                    if (cookies) {
                        resolve(cookies.map(c => this.electronCookieToCxCookie(c)));
                    }
                    resolve([]);
                });
            });
        });
    }
    handleSet(details) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            const { url, name, value, domain, path, secure, httpOnly, expirationDate } = details; // warning(hugo) ignore sameSite & storeId
            return new Promise((resolve) => {
                this.electronCookies.set({ url, name, value, domain, path, secure, httpOnly, expirationDate }, (error) => {
                    if (error && error !== null) {
                        return resolve(undefined);
                    }
                    resolve({
                        name,
                        value,
                        domain,
                        path,
                        secure,
                        httpOnly,
                        expirationDate,
                        storeId: null,
                    });
                });
            });
        });
    }
    handleRemove(details) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            const { url, name } = details; // warning(hugo) ignore storeId
            return new Promise((resolve) => {
                this.electronCookies.remove(url, name, () => {
                    resolve({ url, name, storeId: null });
                });
            });
        });
    }
    handleGetAllCookieStores() { } // warning(hugo) ignore for now
    electronCookieToCxCookie(cookie) {
        const { name, value, domain, hostOnly, path, secure, httpOnly, session, expirationDate, } = cookie;
        return {
            name,
            value,
            domain: domain,
            hostOnly: hostOnly,
            path: path,
            secure: secure,
            httpOnly: httpOnly,
            sameSite: cookies_1.SameSiteStatus.NoRestriction,
            session: session,
            expirationDate,
            storeId: '0',
        };
    }
}
exports.default = Cookies;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29va2llcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9icm93c2VyL2hhbmRsZXJzL2Nvb2tpZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsdUNBQXNEO0FBR3RELHVEQUEyRTtBQUMzRSx3RUFBd0M7QUFFeEMsdUNBQXVDO0FBRXZDLE1BQU0sbUNBQW1DLEdBQUc7SUFDMUMsUUFBUSxFQUFFLFVBQVU7SUFDcEIsU0FBUyxFQUFFLFdBQVc7SUFDdEIsT0FBTyxFQUFFLFNBQVM7SUFDbEIsT0FBTyxFQUFFLFNBQVM7SUFDbEIsbUJBQW1CLEVBQUUsbUJBQW1CO0NBQ3pDLENBQUM7QUFFRixNQUFxQixPQUFRLFNBQVEsaUJBQWU7SUFHbEQsWUFBWSxXQUE2QixFQUFFLE9BQTREO1FBQ3JHLEtBQUssQ0FBQyxXQUFXLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDNUIsSUFBSSxDQUFDLGVBQWUsR0FBRyxrQkFBZSxDQUFDLGNBQWUsQ0FBQyxPQUFPLENBQUM7UUFFL0QsSUFBSSxDQUFDLGVBQWUsQ0FBQyxXQUFXLENBQzlCLFNBQVMsRUFDVCxDQUFDLENBQUMsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxFQUFFO1lBQzVCLE1BQU0sUUFBUSxHQUFHLElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUN2RCxNQUFNLE9BQU8sR0FBRyxtQ0FBbUMsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUUzRCxNQUFNLE9BQU8sR0FBRztnQkFDZCxNQUFNLEVBQUUsUUFBUTtnQkFDaEIsS0FBSyxFQUFFLE9BQU87Z0JBQ2QsT0FBTzthQUNSLENBQUM7WUFFRixJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFNLENBQUMsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZDLENBQUMsQ0FDRixDQUFDO0lBQ0osQ0FBQztJQUVLLFNBQVMsQ0FBQyxPQUEwQzs7WUFDeEQsTUFBTSxFQUFFLEdBQUcs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RTtvQkFDSCxPQUFPLENBQUMsRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO2dCQUN4QyxDQUFDLENBQ0YsQ0FBQztZQUNKLENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQztLQUFBO0lBRUQsd0JBQXdCLEtBQUssQ0FBQyxDQUFDLCtCQUErQjtJQUV0RCx3QkFBd0IsQ0FBQyxNQUF1QjtRQUN0RCxNQUFNLEVBQ0osSUFBSSxFQUNKLEtBQUssRUFDTCxNQUFNLEVBQ04sUUFBUSxFQUNSLElBQUksRUFDSixNQUFNLEVBQ04sUUFBUSxFQUNSLE9BQU8sRUFDUCxjQUFjLEdBQ2YsR0FBRyxNQUFNLENBQUM7UUFFWCxPQUFPO1lBQ0wsSUFBSTtZQUNKLEtBQUs7WUFDTCxNQUFNLEVBQUUsTUFBTztZQUNmLFFBQVEsRUFBRSxRQUFTO1lBQ25CLElBQUksRUFBRSxJQUFLO1lBQ1gsTUFBTSxFQUFFLE1BQU87WUFDZixRQUFRLEVBQUUsUUFBUztZQUNuQixRQUFRLEVBQUUsd0JBQWMsQ0FBQyxhQUFhO1lBQ3RDLE9BQU8sRUFBRSxPQUFRO1lBQ2pCLGNBQWM7WUFDZCxPQUFPLEVBQUUsR0FBRztTQUNiLENBQUM7SUFDSixDQUFDO0NBQ0Y7QUFwSUQsMEJBb0lDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc2Vzc2lvbiBhcyBlbGVjdHJvblNlc3Npb24gfSBmcm9tICdlbGVjdHJvbic7XG5cbmltcG9ydCB7IElFeHRlbnNpb24sIEV4dGVuc2lvbkV2ZW50TWVzc2FnZSB9IGZyb20gJy4uLy4uL2NvbW1vbi90eXBlcyc7XG5pbXBvcnQgeyBDb29raWUsIFNhbWVTaXRlU3RhdHVzLCBFdmVudHMgfSBmcm9tICcuLi8uLi9jb21tb24vYXBpcy9jb29raWVzJztcbmltcG9ydCBIYW5kbGVyIGZyb20gJy4uL2VuZ2luZS9oYW5kbGVyJztcblxuLy8gdG9kbyhodWdvKSBjaGVjayBwZXJtaXNpb25zIGZvciBVUkxzXG5cbmNvbnN0IEVMRUNUUk9OX1RPX0NSWF9DT09LSUVfQ0hBTkdFX0NBVVNFID0ge1xuICBleHBsaWNpdDogJ2V4cGxpY2l0JyxcbiAgb3ZlcndyaXRlOiAnb3ZlcndyaXRlJyxcbiAgZXhwaXJlZDogJ2V4cGlyZWQnLFxuICBldmljdGVkOiAnZXZpY3RlZCcsXG4gICdleHBpcmVkLW92ZXJ3cml0ZSc6ICdleHBpcmVkX292ZXJ3cml0ZScsXG59O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb29raWVzIGV4dGVuZHMgSGFuZGxlcjxFdmVudHM+IHtcbiAgcHJpdmF0ZSBlbGVjdHJvbkNvb2tpZXM6IEVsZWN0cm9uLkNvb2tpZXM7XG5cbiAgY29uc3RydWN0b3IoZXh0ZW5zaW9uSWQ6IElFeHRlbnNpb25bJ2lkJ10sIGVtaXR0ZXI6IChwYXlsb2FkOiBFeHRlbnNpb25FdmVudE1lc3NhZ2VbJ3BheWxvYWQnXSkgPT4gdm9pZCkge1xuICAgIHN1cGVyKGV4dGVuc2lvbklkLCBlbWl0dGVyKTtcbiAgICB0aGlzLmVsZWN0cm9uQ29va2llcyA9IGVsZWN0cm9uU2Vzc2lvbi5kZWZhdWx0U2Vzc2lvbiEuY29va2llcztcblxuICAgIHRoaXMuZWxlY3Ryb25Db29raWVzLmFkZExpc3RlbmVyKFxuICAgICAgJ2NoYW5nZWQnLFxuICAgICAgKF8sIGNvb2tpZSwgY2F1c2UsIHJlbW92ZWQpID0+IHtcbiAgICAgICAgY29uc3QgY3hDb29raWUgPSB0aGlzLmVsZWN0cm9uQ29va2llVG9DeENvb2tpZShjb29raWUpO1xuICAgICAgICBjb25zdCBjeENhdXNlID0gRUxFQ1RST05fVE9fQ1JYX0NPT0tJRV9DSEFOR0VfQ0FVU0VbY2F1c2VdO1xuXG4gICAgICAgIGNvbnN0IGRldGFpbHMgPSB7XG4gICAgICAgICAgY29va2llOiBjeENvb2tpZSxcbiAgICAgICAgICBjYXVzZTogY3hDYXVzZSxcbiAgICAgICAgICByZW1vdmVkLFxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuZW1pdChFdmVudHMuT25DaGFuZ2VkLCBkZXRhaWxzKTtcbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgYXN5bmMgaGFuZGxlR2V0KGRldGFpbHM6IHsgdXJsOiBzdHJpbmcgfSAmIFBhcnRpYWw8Q29va2llPik6IFByb21pc2U8Q29va2llIHwgbnVsbD4ge1xuICAgIGNvbnN0IHsgdXJsLCBuYW1lIH0gPSBkZXRhaWxzOyAvLyB3YXJuaW5nKGh1Z28pIGlnbm9yZSBzdG9yZUlkXG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgIHRoaXMuZWxlY3Ryb25Db29raWVzLmdldChcbiAgICAgICAgeyB1cmwsIG5hbWUgfSxcbiAgICAgICAgKF9lcnJvciwgY29va2llcykgPT4ge1xuICAgICAgICAgIGlmIChjb29raWVzICYmIGNvb2tpZXNbMF0pIHtcbiAgICAgICAgICAgIGNvbnN0IGNvb2tpZSA9IGNvb2tpZXNbMF07XG4gICAgICAgICAgICByZXNvbHZlKHRoaXMuZWxlY3Ryb25Db29raWVUb0N4Q29va2llKGNvb2tpZSkpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIFwiVGhpcyBwYXJhbWV0ZXIgaXMgbnVsbCBpZiBubyBzdWNoIGNvb2tpZSB3YXMgZm91bmRcIlxuICAgICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLmNocm9tZS5jb20vZXh0ZW5zaW9ucy9jb29raWVzI3Byb3BlcnR5LWdldC1jYWxsYmFja1xuICAgICAgICAgIHJlc29sdmUobnVsbCk7XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBoYW5kbGVHZXRBbGwoZGV0YWlsczogeyB1cmw6IHN0cmluZyB9ICYgUGFydGlhbDxDb29raWU+KSB7XG4gICAgY29uc3QgeyB1cmwsIG5hbWUsIGRvbWFpbiwgcGF0aCwgc2VjdXJlLCBzZXNzaW9uIH0gPSBkZXRhaWxzO1xuICAgIC8vIHdhcm5pbmcoaHVnbykgaWdub3JlIHN0b3JlSWRcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgdGhpcy5lbGVjdHJvbkNvb2tpZXMuZ2V0KFxuICAgICAgICB7IHVybCwgbmFtZSwgZG9tYWluLCBwYXRoLCBzZWN1cmUsIHNlc3Npb24gfSxcbiAgICAgICAgKF9lcnJvciwgY29va2llcykgPT4ge1xuICAgICAgICAgIGlmIChjb29raWVzKSB7XG4gICAgICAgICAgICByZXNvbHZlKGNvb2tpZXMubWFwKGMgPT4gdGhpcy5lbGVjdHJvbkNvb2tpZVRvQ3hDb29raWUoYykpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXNvbHZlKFtdKTtcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGhhbmRsZVNldChkZXRhaWxzOiB7IHVybDogc3RyaW5nIH0gJiBQYXJ0aWFsPENvb2tpZT4pIHtcbiAgICBjb25zdCB7IHVybCwgbmFtZSwgdmFsdWUsIGRvbWFpbiwgcGF0aCwgc2VjdXJlLCBodHRwT25seSwgZXhwaXJhdGlvbkRhdGUgfSA9IGRldGFpbHM7IC8vIHdhcm5pbmcoaHVnbykgaWdub3JlIHNhbWVTaXRlICYgc3RvcmVJZFxuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICB0aGlzLmVsZWN0cm9uQ29va2llcy5zZXQoXG4gICAgICAgIHsgdXJsLCBuYW1lLCB2YWx1ZSwgZG9tYWluLCBwYXRoLCBzZWN1cmUsIGh0dHBPbmx5LCBleHBpcmF0aW9uRGF0ZSB9LFxuICAgICAgICAoZXJyb3IpID0+IHtcbiAgICAgICAgICBpZiAoZXJyb3IgJiYgZXJyb3IgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiByZXNvbHZlKHVuZGVmaW5lZCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmVzb2x2ZSh7XG4gICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgICBkb21haW4sXG4gICAgICAgICAgICBwYXRoLFxuICAgICAgICAgICAgc2VjdXJlLFxuICAgICAgICAgICAgaHR0cE9ubHksXG4gICAgICAgICAgICBleHBpcmF0aW9uRGF0ZSxcbiAgICAgICAgICAgIHN0b3JlSWQ6IG51bGwsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfSk7XG5cbiAgfVxuXG4gIGFzeW5jIGhhbmRsZVJlbW92ZShkZXRhaWxzOiB7IHVybDogc3RyaW5nIH0gJiBQYXJ0aWFsPENvb2tpZT4pIHtcbiAgICBjb25zdCB7IHVybCwgbmFtZSB9ID0gZGV0YWlsczsgLy8gd2FybmluZyhodWdvKSBpZ25vcmUgc3RvcmVJZFxuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICB0aGlzLmVsZWN0cm9uQ29va2llcy5yZW1vdmUoXG4gICAgICAgIHVybCxcbiAgICAgICAgbmFtZSEsXG4gICAgICAgICgpID0+IHtcbiAgICAgICAgICByZXNvbHZlKHsgdXJsLCBuYW1lLCBzdG9yZUlkOiBudWxsIH0pO1xuICAgICAgICB9XG4gICAgICApO1xuICAgIH0pO1xuICB9XG5cbiAgaGFuZGxlR2V0QWxsQ29va2llU3RvcmVzKCkgeyB9IC8vIHdhcm5pbmcoaHVnbykgaWdub3JlIGZvciBub3dcblxuICBwcml2YXRlIGVsZWN0cm9uQ29va2llVG9DeENvb2tpZShjb29raWU6IEVsZWN0cm9uLkNvb2tpZSk6IENvb2tpZSB7XG4gICAgY29uc3Qge1xuICAgICAgbmFtZSxcbiAgICAgIHZhbHVlLFxuICAgICAgZG9tYWluLFxuICAgICAgaG9zdE9ubHksXG4gICAgICBwYXRoLFxuICAgICAgc2VjdXJlLFxuICAgICAgaHR0cE9ubHksXG4gICAgICBzZXNzaW9uLFxuICAgICAgZXhwaXJhdGlvbkRhdGUsXG4gICAgfSA9IGNvb2tpZTtcblxuICAgIHJldHVybiB7XG4gICAgICBuYW1lLFxuICAgICAgdmFsdWUsXG4gICAgICBkb21haW46IGRvbWFpbiEsXG4gICAgICBob3N0T25seTogaG9zdE9ubHkhLFxuICAgICAgcGF0aDogcGF0aCEsXG4gICAgICBzZWN1cmU6IHNlY3VyZSEsXG4gICAgICBodHRwT25seTogaHR0cE9ubHkhLFxuICAgICAgc2FtZVNpdGU6IFNhbWVTaXRlU3RhdHVzLk5vUmVzdHJpY3Rpb24sXG4gICAgICBzZXNzaW9uOiBzZXNzaW9uISxcbiAgICAgIGV4cGlyYXRpb25EYXRlLFxuICAgICAgc3RvcmVJZDogJzAnLFxuICAgIH07XG4gIH1cbn1cbiJdfQ==